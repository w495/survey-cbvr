
\section{Деление видео}

Деление видео включает в~себя обнаружение границ съёмок,
извлечение ключевых кадров, сегментацию сцен и~аудио.

\begin{figured}
    \import{vec/}{scene-shot-frame}
    \fcaption{
        Схема визуальной сегментации видео на~примере движения точек.\\
        Временная ось отложена по~горизонтали.
    }
\end{figured}

\subsection{Обнаружение границ съёмок}

Видео делят на~фрагменты по~времени.
В~качестве таких фрагментов могут выступать съёмки.
Съёмка\index{Съёмка}\ (кинематографический кадр\index{Кинематографический кадр},
монтажный план\index{Монтажный план})~— отрезок киноплёнки,
на~котором запечатлено непрерывное действие между~пуском
и~остановкой камеры, или~между~двумя монтажными склейками.

С~точки зрения семантики, самым мелким элементом видео является кадр
(фотографический кадр\index{Фотографический кадр}, кадрик\index{Кадрик}).
Съёмка является более крупным делением.
Из~съёмок складываются сцены, а~из~сцен видео целиком.

Кадры съёмок связаны между~собой по~смыслу.
В~задачах анализа и~поиска съёмки считают
основной структурной единицей видео.

\noindent
Границы съёмок бывают трех типов:
\begin{itemize}
    \item линейная склейка\index{Склейка}~— съёмка внезапно
            прерывается и~начинается другая,
            обычно такой переход занимает 1—2 кадра;
    \item постепенное проявление, исчезновение, проявление или~затухание
            (в~монохромном кадре);
    \item вытеснение\index{Вытеснение}~— исчезновения одной съёмки,
            и~появления другой (растворение, вытеснение шторкой).
\end{itemize}

В~литературе приводят и~иную классификацию границ съёмок:
линейную склейку противопоставляют плавному переходу.
При~этом, затухание, проявление и~вытеснение
рассматривают как~частные случаи плавного перехода \cite{Hattarge:2014}.

Плавную смену съёмок обнаружить сложнее.
Основные подходы обнаружения границ съёмок
вместе с~их~описаниями, преимуществами
и~недостатками всесторонне представлены
в~работах~\cite{Smeaton:2010}, \cite{Nigay:1993} и~\cite{Yuan:2007}.

Для~обнаружения границ съёмок, как~правило,
сначала извлекают визуальные характеристики каждого кадра.
Затем, на~основе выделенных признаков, оценивают сходство между~кадрами.
Границы съёмок определяют по~смене неоднородных кадров.

Выделение съёмок состоит из~следующих этапов:
\begin{itemize}
    \item извлечение признаков \cite{Chantamunee:2007};
    \item измерение сходства;
    \item и~поиска границы.
\end{itemize}


\subsubsection{Извлечение признаков}

Для~определения смен съёмок используют
\begin{itemize}
    \item векторы движения;
    \item цветовые гистограммы \cite{Hoi:2006};
    \item изменения отношения края \cite{Yoo:2006} \cite{Zhao:2006} и \cite{Porter:2004};
    \item преобразование характеристик инвариантное к~масштабу (SIFT\index{SIFT}) \cite{Chang:2008};
    \item карты салиентности \cite{Wu:2008};
    \item угловые точки \cite{Gao:2006} и~так далее.
\end{itemize}

Для~цветовых гистограмм малые движения камеры оказываются очень ощутимыми.
При~изменениях освещения и~движении характеристики краев
более устойчивы. А~влияние смещений объекта
и~камеры могут быть эффективно обработаны характеристиками движения.
Но~как~правило, простые цветовые гистограммы
не~уступают характеристикам краев и~движения
и~более сложными методам \cite{Yuan:2007}.


\subsubsection{Измерение сходства}

Согласно работам \cite{Lu:2004} \cite{Camara-Chavez:2007} \cite{Cooper:2007}
для~оценки подобия между~векторами характеристик кадров используют:
\begin{itemize}
    \item расстояние Евклида;
    \item косинусное расстояние;
    \item сходство по~хи-квадрат;
    \item и~пересечение гистограмм.
\end{itemize}

В~работе \cite{Hoi:2006} предлагают использовать
транспортное расстояние\index{Транспортное расстояние}\ (по~метрике
Канторовича\index{Канторовича метрика}
~—~Рубинштейна\index{Рубинштейна метрика}
~—~Вассерштейна\index{Вассерштейна метрика}
~—~Орнштейна\index{Орнштейна метрика}).
В~англоязычной литературе его называют
«землеройным расстоянием\index{Землеройное расстояние}»~—
Earth Mover's Distance (EMD\index{EMD}).

\subsubsection{Поиск границы}

Для~поиска границ съёмок применяют как~попарное сравнение
кадров, так и~сравнение участков кадров заданного размера \cite{Cooper:2007}.
При~сравнении участок постоянно смещается.
Такие участки называют окнами,
а~сам подход методом скользящего окна\index{Скользящее окно}.

Оконные методы используют контекстную информацию кадров,
что~позволяет сократить влияние локальных шумов и~помех.
Однако они~требуют дополнительных вычислительных затрат.

На~данных момент существует два типа методов обнаружения границ съёмок:
пороговые и~статистические.

% %
% % \begin{figured}
% %     \import{vec/}{boundary-shot-detection}
% %     \fcaption{
% %         Схема визуальной сегментации видео на~примере движения точек.\\
% %         Временная ось отложена по~горизонтали.
% %     }
% % \end{figured}

\paragraph{Пороговые методы}

Пороговые методы попарно сравнивают подобия кадров
с~заданным порогом~\cite{Ko:2006} \cite{Cernekova:2006}.
Если сходство между~кадрами или~«окнами» оказывается ниже
порога, то~граница съёмок считается найденной.
Порог может быть глобальным, адаптивным или~комбинированным.

Глобальный порог подбирается экспериментально
для~всего видео целиком \cite{Cernekova:2006}.
Локальные особенности при~этом не~учитывается,
что~отрицательно влияет на~точность обнаружения.

Алгоритмы адаптивного порога,
основанные на~скользящем окне вычисляют порог локально
\cite{Hoi:2006} \cite{Wu:2008}.
Адаптивный порог дает более высокую точность
нахождения границ \cite{Hanjalic:2002}, но~требует больше
вычислительных ресурсов чем глобальный.
Кроме~того, для~применения адаптивного порога необходимы априорные знания
о~самом видео, например, для~выбора размера окна.

Комбинация адаптивных и~глобальных порогов позволяет
подстраивать локальные пороги при~наличии значения общих параметров.
Например, в~работе~\cite{Quenot:2003} введена пороговая функция.
Значение функции изменяется локально в~пределах двух глобальных порогов.
Глобальные пороги настраиваются в~зависимости
от~требований точности и~полноты.
Однако, отношения локальных адаптивных порогов
и~двух глобальных порогов не~могут быть легко определены.

\paragraph{Статистические методы}

Статистические методы находят границы сцен на~основе характеристик кадров.
Определение границ съёмок может рассматриваться как~задача классификации
на~основе статистического обучения. Кадры классифицируются
как~принадлежащие съёмке, и~не~принадлежащие.
Используются классификаторы с~учителем~— контролируемые и~без~учителя.

\subparagraph{Классификация  с~учителем}

Преимущество таких методов в~том~— что
не~нужно искусственно устанавливать пороги определения границ.
Вместе с~тем, для~повышения точности могут быть использованы
самые разные виды характеристик.
Минус такой классификации~— необходимость аккуратного
выбора примеров для~обучения,
как~положительных, так и~отрицательных.

К~контролируемым классификаторам относят AdaBoost\index{AdaBoost}\ (Adaptive
Boosting~—адаптивное улучшение\index{Адаптивное улучшение})\ и~метод
опорных векторов\index{Метод опорных векторов}\ (МОВ,
SVM\index{SVM}~—support vector machine).

Применяют и~некоторые другие алгоритмы.
В~работе  \cite{Cooper:2007} применяют классификатор
kNN\index{kNN}\ на~основе поиска ближайших соседей,
в~котором сходства кадров на~определенном временно́м интервале используются
как~входные данные.
В~работе \cite{Boreczky:1998} различные виды перехода съёмок находят
с~помощью скрытых моделей Маркова\index{Скрытые
Модели Маркова}\ (HMM\index{HMM}).

\subparagraph{Метод опорных векторов}

Метод опорных векторов \cite{Ngo:2003} \cite{Camara-Chavez:2007} \cite{Matsumoto:2006}
используется для~того, чтобы отличить склейку от~ее~отсутствия.
Для~обработки структур высокой размерности используется,
чтобы уменьшить влияние изменениях при~освещенности
и~быстром перемещении объекта используется
функция ядра\index{Ядро}\index{Kernel function}.
В~работе Чжао \cite{Zhao:2007} для~скользящего окна
применяются два~МОВ-классификатора,
чтобы отличить плавную смену съёмок от~линейных склеек.
В~работе \cite{Ling:2008} МОВ использовали для~классификации кадров
в~трех категориях: постепенный переходы, склейки и~прочие кадры.

В~работах \cite{Yuan:2007} и \cite{Liu:2006} МОВ
комбинируют с~пороговыми методами.
Предварительно границы-кандидаты ищут с~помощью порога.
После этого применяют МОВ-классификатор для~более строго отбора.

\subparagraph{Адаптивное улучшение}

Суть адаптивного улучшения AdaBoost состоит в~усиление простых классификаторов,
путём их комбинирования \cite{Freund:1995}.
В~контексте поиска границ съёмок AdaBoost хорош тем,
что~позволяет использовать большое число различных характеристик.
Классификация с~помощью адаптивного улучшения используется
в~работах \cite{Zhao:2006} и \cite{Herout:2007}.

Чжао и~Цай \cite{Zhao:2006} применяют алгоритм к~обнаружению границ
съёмок для~сжатого видео. Сначала приближенно классифицируются
характеристики цвета и~движения.
Затем каждый кадр классифицируется
как~линейная склейка, плавный переход между~съёмками
или~отсутствие перехода.


\subparagraph{Классификация без~учителя}

Алгоритмы  неконтролируемого обучения делятся на~два типа:
\begin{itemize}
    \item использующие сходство кадров;
    \item использующие сами кадры.
\end{itemize}

Методы на~основе сходства кадров сравнивают меры подобия пар кадров,
и~разбивают их на~две группы~— подобия кадров одной съёмки,
и~подобия кадров, относящихся к~разным съёмкам.
Для~классификации применяются методы
К-средних\index{К-средние}\index{К-means}\ и~нечетких К-средних.

Методы на~основе кадров классифицируют сами кадры
по~визуальному сходству.
Группы похожих кадров относят к~общей съёмке \cite{Chang:2008}.
В~работе \cite{Lu:2004} применяется метод К-средних.
В~работе \cite{Damnjanovic:2007} применяют
спектральную кластеризацию\index{Спектральная кластеризация}.

Преимущество таких методов в~том, что~какая-либо
обучающая выборка не~требуется.
Однако методы не~учитывают временну́ю информацию
и~потому, плавные смены съёмок не~могут быть обнаружены.


\subparagraph{Сжатое видео}

Классификация без~учителя применяется для
определения границ съёмок в~сжатом видео.
Для~выявления съёмок в~таком видео могут быть использованы,
например коэффициенты дискретного косинус-преобразования
(ДКТ\index{ДКТ}\index{DCT}) и~типы макроблоков
\cite{Zhao:2006} \cite{Bruyne:2008} \cite{Koumaras:2006}.
Макроблоками называют участки кадра размером 16 на~16
пикселей. Макроблоки содержат информацию о~типе временно́го
предсказания и~векторы компенсации движения \cite{Gall:1991}

Работа со~сжатым видео позволяет сэкономить
время, затраченное на~распаковку,
но~точность таких методов ниже.


\subsection{Извлечение ключевых кадров}

Среди~кадров одной съёмки есть избыточность.
Для~ее уменьшения выделяют кадры,
которые наиболее полно отражают содержание съёмки.
При~извлечении ключевых кадров\index{Ключевой кадр}\
используют различные характеристики:
\begin{itemize}
    \item цветовые гистограммы\index{Цветовая гистограмма};
    \item края;
    \item очертания;
    \item оптические потоки\index{Оптический поток}.
\end{itemize}

Самый простой способ выбирать ключевые кадры~— это использовать каждый
k-тый кадр в~качестве ключевого. Однако такой способ не~позволяет
учитывать изменения визуальной динамики съёмки.

Способы извлечения подразделяются на~шесть категорий:
\begin{itemize}
    \item последовательное сравнение;
    \item глобальное сравнение;
    \item на~основе ссылочных кадров\index{Ссылочный кадр};
    \item на~основе упрощения кривой разницы кадров;
    \item на~основе кластеризации;
    \item и~на~основе объектов или~событий \cite{Truong:2007}.
\end{itemize}


\subsubsection{Последовательное сравнение}

При~последовательном сравнении ключевой кадр сравнивают
с~другими кадрами до~тех пор пока не~будет найден «сильно отличный».
Для~сопоставления кадров применяют цветовые гистограммы \cite{Zhang:2003}.
В~той~же работе предложена накопленную энергетическую функция в~качестве
расстояния между~парой кадров.

Последовательное сравнение~— интуитивно понятный способ
поиска ключевых кадров.
К~преимуществам подхода строит отнести простоту, точность
и~не~высокую вычислительную сложность.
У~подхода есть существенные недостатки.
\begin{enumerate}
    \item Ключевые кадры описывают только локальные свойства фрагмента.
            Глобальные свойства съёмки никак не~отражены.
    \item Количество ключевых кадров никак не~контролируется.
            Подход нельзя применять, если требуется заданное число
            ключевых кадров.
    \item При~повторении визуального содержимого одни и~те~же
            ключевые кадры будут выделены многократно.
\end{enumerate}

\subsubsection{Глобальное сравнение}

Методы глобального сравнения используют различия между~кадрами
в~съёмке и~распределяют ключевые кадры,
минимизируя предопределенную целевую функцию \cite{Truong:2007}.

\paragraph{Равные временные интервалы}





\subsubsection{Ссылочные кадры}

Выделение ключевых кадров в~таких методах состоит из~двух шагов.
\begin{enumerate}
    \item Ссылочные кадры создаются алгоритмически.
    \item Сравнивают все кадры съёмки со~ссылочными.
\end{enumerate}
Важно заметить, что~не~обязательно пытаться воспроизвести
искусственный ссылочный кадр целиком. Достаточно сконструировать
определенную характеристику кадра.

Например, в~работе \cite{Ferman:2003} строится
aльфа-усеченная средняя цветовая гистограмма съёмки.
Альфа-усеченное усреднение (alpha trimmed mean) представляет из~себя
смесь усредняющего и~медианного фильтров.
«Альфа» (α) в~данном случае, не~имеет никакого отношения к~каналу прозрачности
в~модели (RGBA). В~данном случае «альфа»~— это коэффициент усечения (усреднения),
который позволяет подавить нежелательные шумы.
После построения aльфа-усеченной средней цветовой гистограммы
Вычисляют расстояния между~этой гистограммой и~цветовыми
гистограммами кадров съёмки.
Далее на~основе этого расстояния кадры собирают в~кластеры
и~для~каждого кластера выбирают представителя,
который и~будет являться ключевым кадром.
Авторы предлагают брать центройды кластеров.

В~работе \cite{Sun:2008} конструируют средний кадр съёмки,
который отражает пространственное и~временное распределение
пикселей фрагмента. На~основе похожести кадров съёмки
и~среднего кадру строят кривую расстояний.
Пики этой кривой выбирают в~качестве ключевых кадров.

К~плюсам методов со~ссылочными кадрами строит
отнести понятность и~простоту реализации.
К~минусам~— зависимость от~построения ссылочного кадра,
потенциально есть риск потери информации \cite{Nabeel:2014}.


\subsubsection{Упрощение кривых}

В~работе \cite{Calic:2002} предложен алгоритм реального времени,
который выделяет ключевые кадры на~основе статистики макроблоков
из~потока сжатого видео. Авторы работают с  MPEG-2\index{MPEG-2}.

В~предложенном методе авторы строят кривую разницы кадров.
При~этом учитывается различные типы макроблоков
и~варианты смены контекста видео на~определенном макроблоке.
Построенная кривая разницы кадров содержит в~себе шум.
С~помощью фильтра Гаусса\index{Гаусс}\index{Фильтр Гаусса}
и~дискретного выделения контура (Discrete Contour Evolution\index{DCE})
кривая «спрямляется»~— выделяются сегменты с~наибольшей разницей.

Авторы анализируют углы наклона сегментов кривой
и~на~основе этого выделяют ключевые кадры.
Аналогичным методом в~работе выделяются и~съёмки.

К~минусам подхода стоит отнести рост вычислительной сложности
и~ростом качества спрямления кривой разницы кадров.


\subsection{Сегментация сцен}

Сегментация сцен также известна как~деление сюжета на~блоки.

Сцена представляет собой группу смежных съёмок.
Эти съёмки связаны между~собой конкретной темой или~предметом.
Сцены обладают семантикой более высокого уровня чем съёмки.

Существует три способа сегментации сцен:
\begin{itemize}
    \item деление по~ключевому кадру;
    \item деление на~основе объединения визуальной и~звуковой информации;
    \item деление по~фону.
\end{itemize}

При~делении сцен по~ключевому кадру каждая съёмка представляется набором
ключевых кадров. Для~кадров выявляют их характеристики.
Близкие по~времени кадры с~близкими
характеристиками группируют в~сцены \cite{Truong:2003}.
Далее, используя сравнение блоков ключевых кадров,
вычисляют сходство между~съёмками,
Ограничение деления по~ключевому кадру заключается в~том, что~кадры
не~могут эффективно представить динамическое содержание съёмки.

Съёмки в~пределах сцены, как~правило,
связаны динамическим развитием сюжета в~пределах сцены,
а~не~сходством ключевых кадров.


При~одновременном анализе звуковой и~визуальной информации сменой сцен считают
границу съёмки, где содержимое обоих каналов изменяется одновременно.
Для~определения соответствия между~этими двумя наборами сцен
используют алгоритм поиска ближайшего соседа
с~ограничением по~времени \cite{Sundaram:2000}.
К~минусам подхода следует отнести сложность
определения связи между~аудио сегментами и~визуальными съёмками.

Деление сцен по~фону основано на~гипотезе, что~съёмки,
принадлежащие к~одной сцене часто имеют один и~тот~же фон.
Для~восстановления фона каждого кадра используют объединение
близких по~цвету пикселей в~одноцветные прямоугольные области.
Сходство съёмок определяют с~помощью оценки распределения
цвета и~текстуры всех фоновых изображений в~кадре.
Для~управлением процессом группировки съёмок
применяют кинематографические правила \cite{Chen:2008}.

\subsection{Сегментация звука}

Звуковая дорожка~— богатый источник информации
о~содержании для~всех жанров видео.

Как~показано в~лингвистической литературе границы «высказываний»
выделяются интонационно\index{Интонация}.
На~существенные изменения темы обычно указывают:
\begin{itemize}
    \item длинные паузы;
    \item изменения тона;
    \item и~более изменением амплитуды колебаний.
\end{itemize}

Для~автоматического деления речи на~темы
применяется вероятностная модель связи интонационных
и~лексических сигналов.
Сначала извлекают большое количество интонационных характеристик.
И, таким образом, получают два главных типа речевой просодии\index{Просодия}:
продолжительность и~тон.

На~основе дерева принятия решений выбирают
типичную интонационную функцию.
После чего, лексическая информация извлекается
с~помощью Скрытых Моделей
Маркова\index{Скрытые Модели Маркова}\ (HMM\index{HMM})
и~статистических моделей языка.

Аудио является перспективным источником информации
для~анализа лекционных видео.
Обычно такие видео длятся 60~— 90 минут.
Сложно искать интересующий отрывок по~всему такому видео \cite{Repp:2008}.
Для~решения проблемы используют технологии
распознавания речи\index{Распознавание речи}.
Сначала текст извлекают из~аудио,
а~потом производят индексацию стенограммы для~поиска по~ней \cite{Kumar:2011}.
Например, система распознавания речи Sphinx-4\index{Sphinx-4}\ при~поиске
по~видео достигает полноты 72﹪ и~средней точности 84﹪.

